# ============================================================================
# PRODUCTION-READY 24/7 TRADING SYSTEM CONFIGURATION (V5.0)
# ============================================================================

# ============================================================================
# PHASE 1C ULTRA-AGGRESSIVE CONFIGURATION
# ============================================================================
# Phase 1C thresholds for maximum trading activity
TB_MIN_SIGNAL_QUALITY=1.0              # Ultra-aggressive quality threshold
TB_MIN_CONVICTION_SCORE=2.0             # Low conviction requirement for trade activation

# Enhanced Signal Intelligence System (V5.0)
TB_USE_ENHANCED_SIGNALS=1               # Enable enhanced signal system
TB_ENHANCED_NOTIFICATIONS=1             # Rich Discord/Telegram notifications
TB_SIGNAL_QUALITY_LOGGING=1             # Log signal quality scores

# Enhanced Trade Management
TB_ENHANCED_TRADE_MANAGER=1             # Confidence-based sizing
TB_DAILY_TRADE_LIMIT=8                  # Max trades per agent per day
TB_CONFIDENCE_BASED_SIZING=1            # Dynamic position sizing (20%-100%)

# Enhanced Infrastructure
TB_ENABLE_WATCHDOG=1                    # Auto-restart on failure
TB_HEALTH_CHECK_INTERVAL=900            # Health checks every 15 minutes
TB_AUTO_RECOVERY=1                      # Self-healing mechanisms
TB_ENHANCED_DB_LOGGING=1                # Comprehensive database audit trails

# ============================================================================
# ENHANCED SIGNAL INTELLIGENCE CONFIGURATION (V5.0)
# ============================================================================
# Signal Quality Scoring (0-10 scale)
TB_SENTIMENT_WEIGHT=0.4                 # Sentiment factor weight (0-4 points)
TB_MOMENTUM_WEIGHT=0.3                  # Price momentum weight (0-3 points)
TB_VOLUME_WEIGHT=0.2                    # Volume confirmation weight (0-2 points)
TB_RSI_WEIGHT=0.1                       # RSI extreme bonus weight (0-1 points)

# Market Regime Detection
TB_REGIME_DETECTION=1                   # Enable regime classification
TB_VOLATILITY_REGIMES=1                 # Low/normal/high/extreme volatility
TB_TREND_REGIMES=1                      # Bull/bear/sideways trend detection
TB_REGIME_CONFIDENCE=1                  # Regime confidence scoring

# Conviction Scoring System
TB_QUALITY_WEIGHT=0.4                   # Signal quality factor (40%)
TB_REGIME_WEIGHT=0.3                    # Regime alignment factor (30%)
TB_VOLATILITY_WEIGHT=0.2                # Volatility assessment factor (20%)
TB_CONFIRMATION_WEIGHT=0.1              # Confirmation signals factor (10%)

# ============================================================================
# NOTIFICATION SYSTEMS
# ============================================================================
# Telegram Configuration
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=
TB_NO_TELEGRAM=0                        # Enable Telegram alerts

# Discord Configuration
TB_ENABLE_DISCORD=1                     # Enable Discord notifications
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/<id>/<token>
DISCORD_WEBHOOK_URL_ENHANCED=           # Enhanced notification webhook
DISCORD_POLYMARKET_WEBHOOK_URL=         # Polymarket-specific webhook
DISCORD_CRYPTO_SIGNALS_WEBHOOK_URL=     # Crypto signals webhook
DISCORD_TRADER_WEBHOOK_URL=             # Trading notifications webhook
TB_NO_DISCORD=0

# ============================================================================
# TRADING SYSTEM CONFIGURATION
# ============================================================================
# Safety Controls
TB_NO_TRADE=1                           # Global trading safety gate (set to 0 for live trading)
TB_TRADER_OFFLINE=0                     # Allow real market data for signals
TB_OFFLINE=0                            # Allow real data collection

# Risk Management
TB_MAX_RISK_FRAC=0.003                  # 0.3% per trade (reduced for multi-asset)
TB_PORTFOLIO_VAR_LIMIT=0.02             # 2.0% portfolio VaR
TB_MAX_CORRELATION=0.7                  # Higher correlation OK with diversification

# Multi-Asset Trading
TB_MULTI_ASSET=1                        # Enable multi-asset trading
TB_MAX_POSITIONS=6                      # Increased for more assets
TB_ASSET_LIST=BTCUSD,ETHUSD,ADAUSD,AVAXUSD,SOLUSD,DOTUSD,MATICUSD,LINKUSD,UNIUSD,AAVEUSD,ATOMUSD,ALGOUSD,LTCUSD,BCHUSD,XTZUSD

# ============================================================================
# ALPACA API CREDENTIALS
# ============================================================================
ALPACA_API_KEY_ID=
ALPACA_API_SECRET_KEY=
ALPACA_BASE_URL=https://paper-api.alpaca.markets
ALPACA_DATA_URL=https://data.alpaca.markets

# ============================================================================
# PERPLEXITY API CONFIGURATION
# ============================================================================
# API key rotation (used by universe scans)
PPLX_API_KEY_1=
PPLX_API_KEY_2=
PPLX_API_KEY_3=
PPLX_API_KEY_4=
# Dedicated single key for Polymarket digest
PPLX_API_KEY=
PPLX_MODEL=sonar
PPLX_TIMEOUT=45

# ============================================================================
# LEGACY CONFIGURATION (Maintained for Compatibility)
# ============================================================================
DISCORD_POLYMARKET_WEBHOOK_URL=
# Optional dedicated webhook for Crypto Signals digest
DISCORD_CRYPTO_SIGNALS_WEBHOOK_URL=

# Alpaca (paper trading)
# Keys for paper trading account (NEVER commit real secrets)
ALPACA_API_KEY_ID=
ALPACA_API_SECRET_KEY=
# Paper trading REST endpoint
ALPACA_BASE_URL=https://paper-api.alpaca.markets
# Data endpoint (used by helpers fetching bars/news)
ALPACA_DATA_URL=https://data.alpaca.markets
# Trading safety: set to 1 to disable order placement in any trader scripts
TB_NO_TRADE=1

# Trader defaults / safety gates
TB_TRADER_OFFLINE=1           # preview-only mode (no API calls)
TB_TRADER_TF=1h               # default timeframe for trader
TB_TRADER_RISK_FRAC=0.005     # fraction of equity risked per trade (0.5%)
TB_TRADER_INTERVAL_SEC=60     # loop interval when --loop is enabled
TB_TRADER_COOLDOWN_SEC=900    # per-symbol cooldown to avoid re-entry (15m)
TB_TRADER_MIN_NOTIONAL=10     # enforce minimum order notional (USD quote) for paper trading
TB_MAX_NOTIONAL_PER_TRADE=1000 # hard cap on per-trade notional (USD); trader clamps qty to not exceed this
TB_TRADER_SYMBOLS=BTC/USD,ETH/USD  # limit trading universe (comma-separated)
TB_TRADER_ENTRY_TOL_BPS=10
TB_TRADER_ENTRY_MID_ZONE=1
TB_TRADER_ORDER_TTL_MIN=30
TB_TRADER_MIN_RR=2.0
# Allow short sells for crypto. Note: Alpaca spot crypto does NOT support shorting.
# When 0 (default), SELLs require existing base position > 0 and the trader will skip SELLs without inventory.
TB_TRADER_ALLOW_SHORTS=0
# Longs-only mode: only place BUYs; for SELLs, require inventory; otherwise suppress SELLs silently to avoid spam
TB_TRADER_LONGS_ONLY=1

# Hybrid trader robustness gates (opt-in)
# ML probability gate
TB_USE_ML_GATE=0
TB_ML_GATE_MODEL_PATH=eval_runs/ml/latest/model.pt
TB_ML_FEATURES_PATH=eval_runs/ml/latest/features.csv
TB_ML_GATE_MIN_PROB=0.50

# ATR volatility filter (15m)
TB_USE_ATR_FILTER=0
TB_ATR_LEN=14
TB_ATR_MIN_PCT=0.002
TB_ATR_MAX_PCT=0.10

# Higher-timeframe regime filter (1h EMA)
TB_USE_HTF_REGIME=0
TB_HTF_EMA_LEN=200

# ATR-based stop sizing (replaces fixed TB_SL_PCT when enabled)
TB_USE_ATR_STOP=0
TB_ATR_STOP_MULT=1.5

# Heartbeat notifications (when TB_TRADER_NOTIFY=1)
TB_TRADER_NOTIFY_HEARTBEAT=0
TB_HEARTBEAT_EVERY_N=12

# Trader Discord notifications (optional)
# Set TB_TRADER_NOTIFY=1 to enable; provide a dedicated webhook for live-trades channel
TB_TRADER_NOTIFY=0
DISCORD_TRADER_WEBHOOK_URL=

# Hide equities in chat when no live spot provider; artifacts unaffected
TB_DIGEST_HIDE_EQUITIES_IF_NO_DATA=1

# Universe artifact auto-commit/push
TB_UNIVERSE_GIT_AUTOCOMMIT=1
TB_UNIVERSE_GIT_PUSH=1
TB_UNIVERSE_GIT_PUSH_DEFAULT=1

# Evaluation runs auto-commit/push (eval_runner)
# When enabled, eval CSV outputs under eval_runs/<ts>/ will be staged, committed, and pushed.
# Optionally include eval_data/resolved source CSVs in the same commit.
TB_EVAL_GIT_AUTOCOMMIT=1
TB_EVAL_GIT_PUSH=1
TB_EVAL_GIT_INCLUDE_DATA=0

# Polymarket digest docs auto-commit/push (polymarket_digest_send.py)
# When enabled, polymarket_digest.md will be staged, committed, and pushed after each run.
TB_AUTOCOMMIT_DOCS=1

# Confidence display (opt-in)
# Show internal/model confidence for Polymarket items in chat (percent)
TB_POLYMARKET_SHOW_CONFIDENCE=0
# Show agent-estimated confidence for asset blocks in chat (percent)
TB_SHOW_ASSET_CONFIDENCE_IN_CHAT=0

# Setup grading tunables
# Weights for overall grade calculation
TB_GRADE_W_CONF=0.45
TB_GRADE_W_CONFCHK=0.35
TB_GRADE_W_ALIGN=0.20
# Grade thresholds (map weighted score to letter grades)
TB_GRADE_THRESH_A=0.85
TB_GRADE_THRESH_B=0.70
TB_GRADE_THRESH_C=0.55

# Underrated scanner (Perplexity + enrichment)
# Run interval guard (days); default 7 to avoid spam
TB_UNDERRATED_RUN_INTERVAL_DAYS=7
# Market cap threshold (USD); only alert if <= threshold
TB_UNDERRATED_MARKETCAP_THRESHOLD=10000000
# Alert channel gating (set to 0 to disable)
TB_UNDERRATED_ALERT_DISCORD=1
TB_UNDERRATED_ALERT_TELEGRAM=1
# Optional dedicated Discord webhook for underrated alerts; otherwise uses DISCORD_CRYPTO_SIGNALS_WEBHOOK_URL or DISCORD_WEBHOOK_URL
DISCORD_UNDERRATED_WEBHOOK_URL=
# Persistence store and outputs directory
TB_UNDERRATED_STORE=data/underrated_store.json
TB_UNDERRATED_OUTDIR=underrated_runs
# Auto-commit/push underrated artifacts (JSON/MD under underrated_runs/ and data/underrated_store.json). Scripts are never committed.
TB_UNDERRATED_GIT_AUTOCOMMIT=1
TB_UNDERRATED_GIT_PUSH=1
# Perplexity discovery tuning (recency window in hours; top-N selection; force/dedupe behavior)
TB_UNDERRATED_PPLX_HOURS=72
TB_UNDERRATED_TOP_N=20
# When 1, include top-N even if previously alerted (one-off bulk discovery)
TB_UNDERRATED_FORCE_ALERTS=0
# When 1, re-include a previously alerted project only if its recent signal is within the recency window
TB_UNDERRATED_REINCLUDE_RECENT=1
# When 1, strictly require recent_date within the PPLX hours window for inclusion
TB_UNDERRATED_REQUIRE_RECENT=0
# External APIs (optional: override endpoints)
TB_COINGECKO_API=https://api.coingecko.com/api/v3

# Enhanced Feature Engineering Configuration
# ML model configuration for enhanced feature set (37 indicators)
TB_ML_GATE_MODEL_PATH=eval_runs/ml/latest/model.pt
TB_ML_FEATURES_PATH=eval_runs/ml/latest/features.csv
TB_ML_GATE_MIN_PROB=0.35
TB_USE_ML_GATE=1

# ML monitoring and health checks
TB_ML_GATE_SOFT=1
TB_ML_PROB_FLOOR=0.25
TB_ML_LATEST_MAX_AGE_HR=24

# Risk management enhancements
TB_MAX_NOTIONAL_PER_TRADE=1000
TB_USE_ATR_STOP=1
TB_ATR_STOP_MULT=1.5
TB_SIZE_CONF_FLOOR=0.65
TB_SIZE_CONF_CAP=0.85
TB_SIZE_MIN_R=0.25
TB_SIZE_MAX_R=1.00

# Autonomous operations
TB_AUTOCOMMIT_ARTIFACTS=1
TB_AUTOCOMMIT_PUSH=1
TB_START_MAX_PROMOTED_AGE_DAYS=8
